// (c) 2020-2022 0b5vr - https://github.com/0b5vr/wavenerd-deck/blob/release/LICENSE
var N=Object.defineProperty;var $=(s,t,e)=>t in s?N(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var a=(s,t,e)=>($(s,typeof t!="symbol"?t+"":t,e),e);var d=(s,t,e)=>new Promise((n,r)=>{var i=c=>{try{l(e.next(c))}catch(u){r(u)}},o=c=>{try{l(e.throw(c))}catch(u){r(u)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(i,o);l((e=e.apply(s,t)).next())});var R=s=>[...Array(s)].map((t,e)=>e);var P=class{constructor(s){this.index=0,this.array=s}get current(){return this.array[this.index]}next(){return this.index=(this.index+1)%this.array.length,this.current}};var M=`#version 300 es

precision highp float;

#define _PI 3.14159265359

uniform float bpm;
uniform vec4 timeLength;
uniform float sampleRate;
uniform float _deltaSample;
uniform vec4 _timeHead;

in float off;

out float outL;
out float outR;

float paramFetch( vec4 param ) {
  return mix( param.x, param.y, exp( -param.z * off * _deltaSample ) );
}

float wavetableNearest( sampler2D w, vec4 meta, vec2 position ) {
  vec2 uv0 = fract( vec2(
    position.x,
    ( floor( fract( position.y ) * ( meta.y - 1.0 ) ) + 0.5 ) / meta.y
  ) );
  vec2 uv1 = uv0 + vec2( 0.0, 1.0 / meta.y );
  return mix(
    texture( w, uv0 ).x,
    texture( w, uv1 ).x,
    fract( position.y * ( meta.y - 1.0 ) )
  );
}

float wavetableSinc( sampler2D w, vec4 meta, vec2 position ) {
  float sum = 0.0;
  float def = -fract( position.x * meta.x );
  for ( int i = -5; i <= 5; i ++ ) {
    float x = floor( position.x * meta.x + float( i ) ) / meta.x;
    float deft = def + float( i );
    vec2 uv0 = fract( vec2(
      x,
      ( floor( fract( position.y ) * ( meta.y - 1.0 ) ) + 0.5 ) / meta.y
    ) );
    vec2 uv1 = uv0 + vec2( 0.0, 1.0 / meta.y );
    sum += mix(
      texture( w, uv0 ).x,
      texture( w, uv1 ).x,
      fract( position.y * ( meta.y - 1.0 ) )
    ) * min( sin( deft * _PI ) / deft / _PI, 1.0 );
  }
  return sum;
}

vec2 sampleNearest( sampler2D s, vec4 meta, float time ) {
  if ( meta.w < time ) { return vec2( 0.0 ); }
  float x = time / meta.x * meta.z;
  vec2 uv = fract( vec2(
    x,
    floor( x ) / meta.y
  ) ) + 0.5 / meta.xy;
  return texture( s, uv ).xy;
}

vec2 sampleSinc( sampler2D s, vec4 meta, float time ) {
  if ( meta.w < time ) { return vec2( 0.0 ); }
  vec2 sum = vec2( 0.0 );
  float def = -fract( time * meta.z );
  for ( int i = -5; i <= 5; i ++ ) {
    float x = floor( time * meta.z + float( i ) ) / meta.x;
    float deft = def + float( i );
    vec2 uv = fract( vec2(
      x,
      floor( x ) / meta.y
    ) ) + 0.5 / meta.xy;
    sum += texture( s, uv ).xy * min( sin( deft * _PI ) / deft / _PI, 1.0 );
  }
  return sum;
}
`,A=M.split(`
`).length,F=`void main() {
  vec2 out2 = mainAudio( mod( _timeHead + off * _deltaSample, timeLength ) );
  outL = out2.x;
  outR = out2.y;
}`;function k(s){let t=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);return new Promise((e,n)=>{let r=()=>{let i=s.clientWaitSync(t,0,0);if(i===s.WAIT_FAILED){n();return}if(i===s.TIMEOUT_EXPIRED){setTimeout(r,10);return}s.deleteSync(t),e()};r()})}function I(s,t,e,n={}){var m,b;let{extParallel:r,tfVaryings:i,tfBufferMode:o}=n,l=null,c=null,u=null;try{if(l=s.createShader(s.VERTEX_SHADER),s.shaderSource(l,t),s.compileShader(l),!s.getShaderParameter(l,s.COMPILE_STATUS))throw new Error((m=s.getShaderInfoLog(l))!=null?m:void 0);if(c=s.createShader(s.FRAGMENT_SHADER),s.shaderSource(c,e),s.compileShader(c),!s.getShaderParameter(c,s.COMPILE_STATUS))throw new Error((b=s.getShaderInfoLog(c))!=null?b:void 0);return u=s.createProgram(),s.attachShader(u,l),s.attachShader(u,c),i&&s.transformFeedbackVaryings(u,i,o!=null?o:s.SEPARATE_ATTRIBS),s.linkProgram(u),new Promise((h,_)=>{let g=()=>{var p;if(!r||s.getProgramParameter(u,r.COMPLETION_STATUS_KHR)===!0){s.getProgramParameter(u,s.LINK_STATUS)?h(u):(s.deleteProgram(u),_(new Error((p=s.getProgramInfoLog(u))!=null?p:void 0)));return}setTimeout(g,10)};g()})}catch(h){return s.deleteProgram(u),Promise.reject(h)}finally{s.deleteShader(c),s.deleteShader(l)}}var O=128,W=128;function z(s,t){let e=new Float32Array(R(t)),n=s.createBuffer();return s.bindBuffer(s.ARRAY_BUFFER,n),s.bufferData(s.ARRAY_BUFFER,e,s.STATIC_DRAW),s.bindBuffer(s.ARRAY_BUFFER,null),n}function C(s,t){let e=s.createBuffer();return s.bindBuffer(s.ARRAY_BUFFER,e),s.bufferData(s.ARRAY_BUFFER,t*Float32Array.BYTES_PER_ELEMENT,s.STREAM_READ),s.bindBuffer(s.ARRAY_BUFFER,null),e}function G(s,t){let e=C(s,t),n=C(s,t),r=s.createTransformFeedback(),i=[new Float32Array(t),new Float32Array(t)];return{bufferL:e,bufferR:n,tf:r,dstArrays:i}}var w=class{constructor(t,e){a(this,"gl");a(this,"blocksPerRender");a(this,"useSync");a(this,"__extParallel");a(this,"__tfPool");a(this,"__offsetBuffer");a(this,"__program");a(this,"__programCue");this.blocksPerRender=e,this.gl=t,this.useSync=!1,this.__tfPool=new P(R(W).map(()=>G(t,this.framesPerRender))),this.__extParallel=t.getExtension("KHR_parallel_shader_compile"),this.__offsetBuffer=z(t,this.framesPerRender),this.__program=null,this.__programCue=null}get framesPerRender(){return O*this.blocksPerRender}dispose(){let{gl:t}=this;t.deleteBuffer(this.__offsetBuffer);for(let{bufferL:e,bufferR:n,tf:r}of this.__tfPool.array)t.deleteBuffer(e),t.deleteBuffer(n),t.deleteTransformFeedback(r);t.deleteProgram(this.__program),t.deleteProgram(this.__programCue)}getNextTFPoolEntry(){return this.__tfPool.next()}compile(t){return d(this,null,function*(){let{gl:e}=this,n=yield I(e,M+t+F,`#version 300 es
void main(){discard;}`,{extParallel:this.__extParallel,tfVaryings:["outL","outR"]}).catch(r=>{throw this.__programCue=null,e.deleteProgram(this.__programCue),r});n!=null&&(this.__programCue=n)})}applyCue(){let{gl:t}=this;if(this.__programCue==null)return;let e=this.__program;this.__program=this.__programCue,e!=null&&t.deleteProgram(e),this.__programCue=null}uniform1f(t,e){let{gl:n,__program:r}=this;if(r==null)return;let i=n.getUniformLocation(r,t);n.useProgram(r),n.uniform1f(i,e),n.useProgram(null)}uniform4f(t,...e){let{gl:n,__program:r}=this;if(r==null)return;let i=n.getUniformLocation(r,t);n.useProgram(r),n.uniform4f(i,...e),n.useProgram(null)}uniformTexture(t,e,n){let{gl:r,__program:i}=this;if(i==null)return;let o=r.getUniformLocation(i,t);r.activeTexture(r.TEXTURE0+e),r.bindTexture(r.TEXTURE_2D,n),r.useProgram(i),r.uniform1i(o,e),r.useProgram(null)}render(t,e,n){let{gl:r,__program:i}=this,{bufferL:o,bufferR:l,tf:c}=t;if(i==null)return;let u=r.getAttribLocation(i,"off");r.bindBuffer(r.ARRAY_BUFFER,this.__offsetBuffer),r.enableVertexAttribArray(u),r.vertexAttribPointer(u,1,r.FLOAT,!1,0,0),r.useProgram(i),r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,c),r.bindBufferRange(r.TRANSFORM_FEEDBACK_BUFFER,0,o,4*e,4*n),r.bindBufferRange(r.TRANSFORM_FEEDBACK_BUFFER,1,l,4*e,4*n),r.enable(r.RASTERIZER_DISCARD),r.beginTransformFeedback(r.POINTS),r.drawArrays(r.POINTS,e,n),r.endTransformFeedback(),r.disable(r.RASTERIZER_DISCARD),r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),r.useProgram(null)}readBuffer(r){return d(this,arguments,function*({bufferL:t,bufferR:e,dstArrays:n}){let{gl:i}=this;this.useSync&&(yield k(i)),i.bindBuffer(i.ARRAY_BUFFER,t),i.getBufferSubData(i.ARRAY_BUFFER,0,n[0],0,this.framesPerRender),i.bindBuffer(i.ARRAY_BUFFER,null),i.bindBuffer(i.ARRAY_BUFFER,e),i.getBufferSubData(i.ARRAY_BUFFER,0,n[1],0,this.framesPerRender),i.bindBuffer(i.ARRAY_BUFFER,null)})}};var y=class{constructor(){a(this,"__eventListeners")}on(t,e){this.__eventListeners=this.__eventListeners||new Map;let n=this.__eventListeners.get(t);return n||(n=[],this.__eventListeners.set(t,n)),n.push(e),e}off(t,e){this.__eventListeners=this.__eventListeners||new Map;let n=this.__eventListeners.get(t);n||(n=[],this.__eventListeners.set(t,n));let r=n.indexOf(e);r!==-1&&n.splice(r,1)}__emit(...[t,e]){var n;this.__eventListeners=this.__eventListeners||new Map,(n=this.__eventListeners.get(t))==null||n.forEach(r=>r(e))}};function T(s,t){t.forEach(e=>{Object.getOwnPropertyNames(e.prototype).forEach(n=>{Object.defineProperty(s.prototype,n,Object.getOwnPropertyDescriptor(e.prototype,n))})})}function S(s,t){return s-Math.floor(s/t)*t}var f=class{constructor(){a(this,"__bpm",140);a(this,"__time",0);a(this,"__beat",0);a(this,"__bar",0);a(this,"__sixteenBar",0)}static CalcBeatSeconds(t){return 60/t}static CalcBarSeconds(t){return 240/t}static CalcSixteenBarSeconds(t){return 3840/t}get bpm(){return this.__bpm}set bpm(t){let e=this.__bpm;this.__bpm=Math.max(0,t),this.__sixteenBar=this.__sixteenBar*e/this.__bpm,this.__emit("changeBPM",{bpm:this.__bpm})}get beatSeconds(){return f.CalcBeatSeconds(this.__bpm)}get barSeconds(){return f.CalcBarSeconds(this.__bpm)}get sixteenBarSeconds(){return f.CalcSixteenBarSeconds(this.__bpm)}get time(){return this.__time}get beat(){return this.__beat}get bar(){return this.__bar}get sixteenBar(){return this.__sixteenBar}reset(){this.__time=0,this.__sixteenBar=0}update(t){let e=f.CalcBeatSeconds(this.__bpm),n=f.CalcBarSeconds(this.__bpm),r=f.CalcSixteenBarSeconds(this.__bpm),i=t-this.__time;this.__sixteenBar=S(this.__sixteenBar+i,r),this.__bar=S(this.__sixteenBar,n),this.__beat=S(this.__bar,e),this.__time=t;let o={time:t,bpm:this.__bpm,beat:this.__beat,bar:this.__bar,sixteenBar:this.__sixteenBar};return this.__emit("update",o),o}};T(f,[y]);var L=`/* eslint-disable */

const BLOCK_SIZE = 128;
const CHANNELS = 2;
const BUFFER_SIZE_PER_CHANNEL = 65536;

class BufferReaderProcessor extends AudioWorkletProcessor {
  constructor() {
    super();

    this.active = false;
    this.buffer = new Float32Array( CHANNELS * BUFFER_SIZE_PER_CHANNEL );

    this.port.onmessage = ( { data } ) => {
      if ( Array.isArray( data ) ) {
        this.buffer.set( ...data );
      } else {
        this.active = data;
      }
    };
  }

  process( inputs, outputs, parameters ) {
    if ( !this.active ) { return true; }

    const buffer = this.buffer;

    const head = currentFrame % BUFFER_SIZE_PER_CHANNEL;

    outputs[ 0 ].forEach( ( ch, iCh ) => {
      const chHead = BUFFER_SIZE_PER_CHANNEL * iCh + head;
      ch.set( buffer.subarray( chHead, chHead + BLOCK_SIZE ) );
    } );

    this.port.postMessage( currentFrame / BLOCK_SIZE );

    return true;
  }
}

registerProcessor( 'buffer-reader-processor', BufferReaderProcessor );
`;var X=128,q=2,B=65536,Y=new Blob([L],{type:"text/javascript"}),Z=URL.createObjectURL(Y),v=class extends AudioWorkletNode{constructor(e){super(e,"buffer-reader-processor",{numberOfInputs:0,numberOfOutputs:1,outputChannelCount:[q]});a(this,"__readBlocks");this.__readBlocks=0,this.port.onmessage=({data:n})=>{this.__readBlocks=n}}get readBlocks(){return this.__readBlocks}static addModule(e){return e.audioWorklet.addModule(Z)}setActive(e){this.port.postMessage(e)}write(e,n,r,i){let o=B*e+X*n%B+r;this.port.postMessage([i,o])}};var E=class{constructor(t){a(this,"gl");a(this,"__textures");this.gl=t,this.__textures=new Map}get textureIds(){return this.__textures.keys()}dispose(){let{gl:t}=this;this.__textures.forEach(e=>{t.deleteTexture(e.texture)}),this.__textures.clear()}get(t){var e;return(e=this.__textures.get(t))!=null?e:null}loadWavetable(t,e){let n=e.length/2048,r=new Float32Array(e.length*4);for(let l=0;l<e.length;l++)r[l*4+0]=e[l];let i=this.__uploadTexture(2048,n,r),o={type:"wavetable",width:2048,height:n,texture:i};return this.__textures.set(t,o),o}loadImage(t,e){let n=this.__uploadImageSource(e),r={type:"image",width:e.width,height:e.height,texture:n};return this.__textures.set(t,r),r}loadSample(t,e){let{sampleRate:n,duration:r}=e,i=e.length,o=2048,c=Math.ceil(i/2048),u=new Float32Array(o*c*4),m=e.numberOfChannels,b=e.getChannelData(0),h=e.getChannelData(m===1?0:1);for(let p=0;p<i;p++)u[p*4+0]=b[p],u[p*4+1]=h[p];let _=this.__uploadTexture(o,c,u),g={type:"sample",width:o,height:c,sampleRate:n,duration:r,texture:_};return this.__textures.set(t,g),g}delete(t){let{gl:e}=this,n=this.__textures.get(t);return n==null?!1:(e.deleteTexture(n.texture),this.__textures.delete(t),!0)}__uploadTexture(t,e,n){let{gl:r}=this,i=r.createTexture();return r.bindTexture(r.TEXTURE_2D,i),r.texImage2D(r.TEXTURE_2D,0,r.RGBA32F,t,e,0,r.RGBA,r.FLOAT,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.bindTexture(r.TEXTURE_2D,null),i}__uploadImageSource(t){let{gl:e}=this,n=e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA8,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.bindTexture(e.TEXTURE_2D,null),n}};function D(s,t,e){return s+(t-s)*e}var U=128,x=class{constructor({gl:t,audio:e,hostDeck:n,latencyBlocks:r,blocksPerRender:i,bpm:o}){a(this,"hostDeck");a(this,"latencyBlocks");a(this,"__cueStatus","none");a(this,"__blocksPerRender");a(this,"__isPlaying");a(this,"__lastUpdatedTime");a(this,"__renderer");a(this,"__lastError");a(this,"__audio");a(this,"__node");a(this,"__bufferReaderNode");a(this,"__bufferWriteBlocks");a(this,"__blockOffset");a(this,"__beatManager");a(this,"__program");a(this,"__programCue");a(this,"__programSwapTime");a(this,"__params",new Map);a(this,"__selfTextureStore");this.__isPlaying=!1,this.latencyBlocks=r!=null?r:16,this.__blocksPerRender=i!=null?i:16,n&&(this.hostDeck=n),this.__beatManager=new f,this.__beatManager.bpm=o!=null?o:140,this.__beatManager.on("changeBPM",({bpm:l})=>{this.__emit("changeBPM",{bpm:l})}),this.__lastUpdatedTime=0,n&&n.on("rewind",()=>{this.rewind()}),this.__renderer=new w(t,this.blocksPerRender),this.__selfTextureStore=new E(t),this.__program=null,this.__programCue=null,this.__programSwapTime=null,this.__audio=e,this.__node=e.createGain(),v.addModule(e).then(()=>{this.__bufferReaderNode=new v(e),this.__bufferReaderNode.connect(this.__node)}),this.__bufferWriteBlocks=0,this.__blockOffset=0}get cueStatus(){return this.__cueStatus}get blocksPerRender(){return this.__blocksPerRender}get framesPerRender(){return U*this.__blocksPerRender}get isPlaying(){var t,e;return(e=(t=this.hostDeck)==null?void 0:t.__isPlaying)!=null?e:this.__isPlaying}get bpm(){return this.beatManager.bpm}set bpm(t){this.beatManager.bpm=t}get useSync(){return this.__renderer.useSync}set useSync(t){this.__renderer.useSync=t}get lastError(){return this.__lastError}get audio(){return this.__audio}get node(){return this.__node}get sampleRate(){return this.__audio.sampleRate}get beatManager(){var e;let t=(e=this.hostDeck)==null?void 0:e.beatManager;return t||this.__beatManager}get params(){return this.__params}get __textureStore(){return this.hostDeck?this.hostDeck.__textureStore:this.__selfTextureStore}dispose(){var t;this.__setCueStatus("none"),this.__renderer.dispose(),this.__selfTextureStore.dispose(),(t=this.__bufferReaderNode)==null||t.disconnect()}play(){this.__isPlaying=!0,this.__emit("play")}pause(){this.__isPlaying=!1,this.__emit("pause")}rewind(){this.__lastUpdatedTime=0,this.__blockOffset=this.__bufferWriteBlocks,this.__beatManager.reset(),this.applyCueImmediately(),this.__emit("rewind")}compile(t){return d(this,null,function*(){this.__setCueStatus("compiling"),yield this.__renderer.compile(t).catch(n=>{let r=this.__processErrorMessage(n);throw this.__programCue=null,this.__setCueStatus("none"),this.__emit("error",{error:r}),this.__lastError=r,new Error(r!=null?r:void 0)});let e=new Set;for(let n of this.__textureStore.textureIds)t.search(n)!==-1&&e.add(n);this.__programCue={code:t,requiredTextures:e},this.__setCueStatus("ready"),this.__emit("error",{error:null}),this.__lastError=null})}applyCue(){this.__cueStatus==="ready"&&(this.__setCueStatus("applying"),this.__programSwapTime=this.beatManager.time-this.beatManager.bar+this.beatManager.barSeconds)}applyCueImmediately(){this.__programCue!=null&&(this.__setCueStatus("none"),this.__renderer.applyCue(),this.__program=this.__programCue,this.__programCue=null,this.__programSwapTime=null)}setParam(t,e,n=50){let r=this.params.get(t);r?(r.target=e,r.factor=n):this.params.set(t,{name:t,target:e,value:e,factor:n}),this.__emit("setParam",{name:t,value:e,factor:n})}loadWavetable(t,e){let n=`wavetable_${t}`;this.__textureStore.loadWavetable(n,e),this.__addRequiredTexture(n),this.__emit("loadWavetable",{name:t})}deleteWavetable(t){this.__textureStore.delete(`wavetable_${t}`)&&this.__emit("deleteWavetable",{name:t})}loadImage(t,e){let n=`image_${t}`;this.__textureStore.loadImage(n,e),this.__addRequiredTexture(n),this.__emit("loadImage",{name:t})}deleteImage(t){this.__textureStore.delete(`image_${t}`)&&this.__emit("deleteImage",{name:t})}loadSample(t,e){return d(this,null,function*(){let n=yield this.__audio.decodeAudioData(e),r=`sample_${t}`,{duration:i,sampleRate:o}=this.__textureStore.loadSample(r,n);this.__addRequiredTexture(r),this.__emit("loadSample",{name:t,duration:i,sampleRate:o})})}deleteSample(t){this.__textureStore.delete(`success_${t}`)&&this.__emit("deleteSample",{name:t})}update(){return d(this,null,function*(){var m;let t=this.__bufferReaderNode;if(t==null)return;let{readBlocks:e}=t,{sampleRate:n,blocksPerRender:r,framesPerRender:i}=this;if((m=this.__bufferReaderNode)==null||m.setActive(this.isPlaying),!this.isPlaying)return;let o=this.__bufferWriteBlocks-e;if(o>this.latencyBlocks)return;o<0&&(this.__bufferWriteBlocks=(Math.floor(e/r)+1)*r);let l=U*(this.__bufferWriteBlocks-this.__blockOffset)/n;this.beatManager.update(l);let c=this.__programSwapTime!=null?Math.floor((this.__programSwapTime-l)*n):i;c=Math.min(c,i),c<0&&(this.applyCueImmediately(),c=i);let u=this.__renderer.getNextTFPoolEntry();this.__program&&(this.__updateUniforms(),this.__renderer.render(u,0,c)),c<i&&this.__programCue!=null&&(this.applyCueImmediately(),this.__updateUniforms(),this.__renderer.render(u,c,i-c)),this.__readBuffer(u,this.__bufferWriteBlocks),this.__bufferWriteBlocks+=this.blocksPerRender,this.__emit("update")})}__addRequiredTexture(t){this.__program&&this.__program.code.search(t)&&this.__program.requiredTextures.add(t),this.__programCue&&this.__programCue.code.search(t)&&this.__programCue.requiredTextures.add(t)}__updateUniforms(){let{time:t,beatSeconds:e,barSeconds:n,sixteenBarSeconds:r,beat:i,bar:o,sixteenBar:l}=this.beatManager,{sampleRate:c}=this,u=t-this.__lastUpdatedTime;this.__lastUpdatedTime=t,this.params.forEach(h=>{h.factor<=0?h.value=h.target:h.value=D(h.target,h.value,Math.exp(-h.factor*u)),this.__renderer.uniform4f("param_"+h.name,h.target,h.value,h.factor,0)});let m=0,{requiredTextures:b}=this.__program;for(let h of b){let _=this.__textureStore.get(h);if(_!=null){this.__renderer.uniformTexture(h,m,_.texture),m++;let g=_.type==="sample"?[_.width,_.height,_.sampleRate,_.duration]:[_.width,_.height,0,0];this.__renderer.uniform4f(h+"_meta",...g)}}this.__renderer.uniform1f("bpm",this.bpm),this.__renderer.uniform1f("_deltaSample",1/c),this.__renderer.uniform4f("timeLength",e,n,r,1e16),this.__renderer.uniform4f("_timeHead",i,o,l,t)}__readBuffer(t,e){return d(this,null,function*(){let n=this.__bufferReaderNode;n!=null&&(yield this.__renderer.readBuffer(t),n.write(0,e,0,t.dstArrays[0].subarray(0,this.framesPerRender)),n.write(1,e,0,t.dstArrays[1].subarray(0,this.framesPerRender)))})}__setCueStatus(t){this.__cueStatus=t,this.__emit("changeCueStatus",{cueStatus:t})}__processErrorMessage(t){var n;let e=(n=t==null?void 0:t.message)!=null?n:t;return e?e.replace(/ERROR: (\d+):(\d+)/g,(r,...i)=>{let o=parseInt(i[1])-A+1;return`ERROR: ${i[0]}:${o}`}):null}};T(x,[y]);var At=x;export{f as BeatManager,x as WavenerdDeck,At as default};
/*!
 * Turbo colormap
 *
 * Copyright 2019 Google LLC. (Apache-2.0)
 *
 * https://gist.github.com/mikhailov-work/0d177465a8151eb6ede1768d51d476c7
 */
/*!
* @0b5vr/experimental v0.9.5
* Experimental edition of 0b5vr
*
* Copyright (c) 2019-2023 0b5vr
* @0b5vr/experimental is distributed under MIT License
* https://github.com/0b5vr/experimental-npm/blob/release/LICENSE
*/
//# sourceMappingURL=wavenerd-deck.esm.min.js.map
