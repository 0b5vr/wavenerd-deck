{
  "version": 3,
  "sources": ["../src/index.ts", "../src/utils/EventEmittable.ts", "../src/utils/applyMixins.ts", "../src/utils/mod.ts", "../src/BeatManager.ts", "../src/BufferReaderNode.ts", "../src/shaderchunks.ts", "../src/utils/lazyProgram.ts", "../src/Renderer.ts", "../src/TextureStore.ts", "../src/utils/lerp.ts", "../src/WavenerdDeck.ts"],
  "sourcesContent": ["export { WavenerdDeck } from './WavenerdDeck';\nexport { BeatManager } from './BeatManager';\n\nimport { WavenerdDeck } from './WavenerdDeck';\nexport default WavenerdDeck;\n", "// Ref: https://github.com/andywer/typed-emitter/blob/master/index.d.ts\n\nexport type EventListener<T> = ( event: T ) => void;\n\nexport class EventEmittable<TEvents extends { [ type: string ]: any }> {\n  protected __eventListeners?: Map<keyof TEvents, EventListener<any>[]>;\n\n  public on<TType extends keyof TEvents & string>(\n    type: TType,\n    listener: EventListener<TEvents[ TType ]>\n  ): EventListener<TEvents[ TType ]> {\n    this.__eventListeners = this.__eventListeners || new Map();\n    let array = this.__eventListeners.get( type );\n    if ( !array ) {\n      array = [];\n      this.__eventListeners.set( type, array );\n    }\n\n    array.push( listener );\n\n    return listener;\n  }\n\n  public off<TType extends keyof TEvents & string>(\n    type: TType,\n    listener: EventListener<TEvents[ TType ]>\n  ): void {\n    this.__eventListeners = this.__eventListeners || new Map();\n    let array = this.__eventListeners.get( type );\n    if ( !array ) {\n      array = [];\n      this.__eventListeners.set( type, array );\n    }\n\n    const index = array.indexOf( listener );\n    if ( index !== -1 ) {\n      array.splice( index, 1 );\n    }\n  }\n\n  protected __emit<TType extends keyof TEvents>(\n    ...[ type, event ]: TEvents[ TType ] extends void ? [ TType ] : [ TType, TEvents[ TType ] ]\n  ): void {\n    this.__eventListeners = this.__eventListeners || new Map();\n    this.__eventListeners.get( type )?.forEach( ( listener ) => listener( event ) );\n  }\n}\n", "export function applyMixins( derivedCtor: any, baseCtors: any[] ): void {\n  baseCtors.forEach( ( baseCtor ) => {\n    Object.getOwnPropertyNames( baseCtor.prototype ).forEach( ( name ) => {\n      Object.defineProperty(\n        derivedCtor.prototype,\n        name,\n        Object.getOwnPropertyDescriptor( baseCtor.prototype, name )!\n      );\n    } );\n  } );\n}\n", "export function mod( value: number, divisor: number ): number {\n  return value - Math.floor( value / divisor ) * divisor;\n}\n", "import { EventEmittable } from './utils/EventEmittable';\nimport { applyMixins } from './utils/applyMixins';\nimport { mod } from './utils/mod';\n\nexport interface BeatManagerUpdateEvent {\n  time: number;\n  bpm: number;\n  beat: number;\n  bar: number;\n  sixteenBar: number;\n}\n\nexport class BeatManager {\n  public static CalcBeatSeconds( bpm: number ): number {\n    return 60.0 / bpm;\n  }\n\n  public static CalcBarSeconds( bpm: number ): number {\n    // return this.beatLength * 4.0;\n    return 240.0 / bpm;\n  }\n\n  public static CalcSixteenBarSeconds( bpm: number ): number {\n    // return this.barLength * 16.0;\n    return 3840.0 / bpm;\n  }\n\n  private __bpm = 140.0;\n  public get bpm(): number {\n    return this.__bpm;\n  }\n  public set bpm( value: number ) {\n    const prevBpm = this.__bpm;\n    this.__bpm = Math.max( 0.0, value );\n    this.__sixteenBar = this.__sixteenBar * prevBpm / this.__bpm;\n    this.__emit( 'changeBPM', { bpm: this.__bpm } );\n  }\n\n  public get beatSeconds(): number {\n    return BeatManager.CalcBeatSeconds( this.__bpm );\n  }\n\n  public get barSeconds(): number {\n    return BeatManager.CalcBarSeconds( this.__bpm );\n  }\n\n  public get sixteenBarSeconds(): number {\n    return BeatManager.CalcSixteenBarSeconds( this.__bpm );\n  }\n\n  private __time = 0.0;\n  public get time(): number {\n    return this.__time;\n  }\n\n  private __beat = 0.0;\n  public get beat(): number {\n    return this.__beat;\n  }\n\n  private __bar = 0.0;\n  public get bar(): number {\n    return this.__bar;\n  }\n\n  private __sixteenBar = 0.0;\n  public get sixteenBar(): number {\n    return this.__sixteenBar;\n  }\n\n  public reset(): void {\n    this.__time = 0.0;\n    this.__sixteenBar = 0.0;\n  }\n\n  public update( time: number ): BeatManagerUpdateEvent {\n    const beatSeconds = BeatManager.CalcBeatSeconds( this.__bpm );\n    const barSeconds = BeatManager.CalcBarSeconds( this.__bpm );\n    const sixteenBarSeconds = BeatManager.CalcSixteenBarSeconds( this.__bpm );\n\n    const delta = time - this.__time;\n\n    this.__sixteenBar = mod( this.__sixteenBar + delta, sixteenBarSeconds );\n    this.__bar = mod( this.__sixteenBar, barSeconds );\n    this.__beat = mod( this.__bar, beatSeconds );\n\n    this.__time = time;\n\n    const event = {\n      time,\n      bpm: this.__bpm,\n      beat: this.__beat,\n      bar: this.__bar,\n      sixteenBar: this.__sixteenBar,\n    };\n\n    this.__emit( 'update', event );\n\n    return event;\n  }\n}\n\nexport interface BeatManager extends EventEmittable<{\n  update: BeatManagerUpdateEvent;\n  changeBPM: { bpm: number };\n}> {}\napplyMixins( BeatManager, [ EventEmittable ] );\n", "import processorCode from './BufferReaderProcessor.worklet.js';\n\nconst BLOCK_SIZE = 128;\nconst CHANNELS = 2;\nconst BUFFER_SIZE_PER_CHANNEL = 65536;\n\nconst processorBlob = new Blob( [ processorCode ], { type: 'text/javascript' } );\nconst processorUrl = URL.createObjectURL( processorBlob );\n\nexport class BufferReaderNode extends AudioWorkletNode {\n  private __readBlocks: number;\n\n  public get readBlocks(): number {\n    return this.__readBlocks;\n  }\n\n  public static addModule( audio: AudioContext ): Promise<void> {\n    return audio.audioWorklet.addModule( processorUrl );\n  }\n\n  public setActive( isActive: boolean ): void {\n    this.port.postMessage( isActive );\n  }\n\n  public constructor( audio: AudioContext ) {\n    super( audio, 'buffer-reader-processor', {\n      numberOfInputs: 0,\n      numberOfOutputs: 1,\n      outputChannelCount: [ CHANNELS ],\n    } );\n\n    this.__readBlocks = 0;\n\n    this.port.onmessage = ( ( { data } ) => {\n      this.__readBlocks = data;\n    } );\n  }\n\n  public write( channel: number, block: number, offset: number, buffer: ArrayLike<number> ): void {\n    const totalOffset = (\n      BUFFER_SIZE_PER_CHANNEL * channel\n      + ( BLOCK_SIZE * block ) % BUFFER_SIZE_PER_CHANNEL\n      + offset\n    );\n    this.port.postMessage( [ buffer, totalOffset ] );\n  }\n}\n", "export const shaderchunkPre = `#version 300 es\n\nprecision highp float;\n\n#define _PI 3.14159265359\n\nuniform float bpm;\nuniform vec4 timeLength;\nuniform float sampleRate;\nuniform float _deltaSample;\nuniform vec4 _timeHead;\n\nin float off;\n\nout float outL;\nout float outR;\n\nfloat paramFetch( vec4 param ) {\n  return mix( param.x, param.y, exp( -param.z * off * _deltaSample ) );\n}\n\nfloat wavetableNearest( sampler2D w, vec4 meta, vec2 position ) {\n  vec2 uv0 = fract( vec2(\n    position.x,\n    ( floor( fract( position.y ) * ( meta.y - 1.0 ) ) + 0.5 ) / meta.y\n  ) );\n  vec2 uv1 = uv0 + vec2( 0.0, 1.0 / meta.y );\n  return mix(\n    texture( w, uv0 ).x,\n    texture( w, uv1 ).x,\n    fract( position.y * ( meta.y - 1.0 ) )\n  );\n}\n\nfloat wavetableSinc( sampler2D w, vec4 meta, vec2 position ) {\n  float sum = 0.0;\n  float def = -fract( position.x * meta.x );\n  for ( int i = -5; i <= 5; i ++ ) {\n    float x = floor( position.x * meta.x + float( i ) ) / meta.x;\n    float deft = def + float( i );\n    vec2 uv0 = fract( vec2(\n      x,\n      ( floor( fract( position.y ) * ( meta.y - 1.0 ) ) + 0.5 ) / meta.y\n    ) );\n    vec2 uv1 = uv0 + vec2( 0.0, 1.0 / meta.y );\n    sum += mix(\n      texture( w, uv0 ).x,\n      texture( w, uv1 ).x,\n      fract( position.y * ( meta.y - 1.0 ) )\n    ) * min( sin( deft * _PI ) / deft / _PI, 1.0 );\n  }\n  return sum;\n}\n\nvec2 sampleNearest( sampler2D s, vec4 meta, float time ) {\n  if ( meta.w < time ) { return vec2( 0.0 ); }\n  float x = time / meta.x * meta.z;\n  vec2 uv = fract( vec2(\n    x,\n    floor( x ) / meta.y\n  ) ) + 0.5 / meta.xy;\n  return texture( s, uv ).xy;\n}\n\nvec2 sampleSinc( sampler2D s, vec4 meta, float time ) {\n  if ( meta.w < time ) { return vec2( 0.0 ); }\n  vec2 sum = vec2( 0.0 );\n  float def = -fract( time * meta.z );\n  for ( int i = -5; i <= 5; i ++ ) {\n    float x = floor( time * meta.z + float( i ) ) / meta.x;\n    float deft = def + float( i );\n    vec2 uv = fract( vec2(\n      x,\n      floor( x ) / meta.y\n    ) ) + 0.5 / meta.xy;\n    sum += texture( s, uv ).xy * min( sin( deft * _PI ) / deft / _PI, 1.0 );\n  }\n  return sum;\n}\n`;\n\nexport const shaderchunkPreLines = shaderchunkPre.split( '\\n' ).length;\n\nexport const shaderchunkPost = `void main() {\n  vec2 out2 = mainAudio( mod( _timeHead + off * _deltaSample, timeLength ) );\n  outL = out2.x;\n  outR = out2.y;\n}`;\n", "export function lazyProgram(\n  gl: WebGL2RenderingContext,\n  vert: string,\n  frag: string,\n  options: {\n    /**\n     * `KHR_parallel_shader_compile`.\n     * Compile async if provided.\n     */\n    extParallel?: any,\n\n    tfVaryings?: string[],\n\n    /**\n     * `gl.SEPARATE_ATTRIBS` by default\n     */\n    tfBufferMode?: number,\n  } = {},\n): Promise<WebGLProgram> {\n  const { extParallel, tfVaryings, tfBufferMode } = options;\n\n  let vertexShader: WebGLShader | null = null;\n  let fragmentShader: WebGLShader | null = null;\n  let program: WebGLProgram | null = null;\n\n  try {\n    // == vert =====================================================================================\n    vertexShader = gl.createShader( gl.VERTEX_SHADER )!;\n\n    gl.shaderSource( vertexShader, vert );\n    gl.compileShader( vertexShader );\n\n    if ( !gl.getShaderParameter( vertexShader, gl.COMPILE_STATUS ) ) {\n      throw new Error( gl.getShaderInfoLog( vertexShader ) ?? undefined );\n    }\n\n    // == frag =====================================================================================\n    fragmentShader = gl.createShader( gl.FRAGMENT_SHADER )!;\n\n    gl.shaderSource( fragmentShader, frag );\n    gl.compileShader( fragmentShader );\n\n    if ( !gl.getShaderParameter( fragmentShader, gl.COMPILE_STATUS ) ) {\n      throw new Error( gl.getShaderInfoLog( fragmentShader ) ?? undefined );\n    }\n\n    // == program ==================================================================================\n    program = gl.createProgram()!;\n\n    gl.attachShader( program, vertexShader );\n    gl.attachShader( program, fragmentShader );\n\n    if ( tfVaryings ) {\n      gl.transformFeedbackVaryings(\n        program,\n        tfVaryings,\n        tfBufferMode ?? gl.SEPARATE_ATTRIBS,\n      );\n    }\n\n    gl.linkProgram( program );\n\n    return new Promise( ( resolve, reject ) => {\n      const update = () => {\n        if (\n          !extParallel ||\n          gl.getProgramParameter( program!, extParallel.COMPLETION_STATUS_KHR ) === true\n        ) {\n          if ( !gl.getProgramParameter( program!, gl.LINK_STATUS ) ) {\n            gl.deleteProgram( program );\n            reject( new Error( gl.getProgramInfoLog( program! ) ?? undefined ) );\n          } else {\n            resolve( program! );\n          }\n\n          return;\n        }\n\n        setTimeout( update, 10 );\n      };\n      update();\n    } );\n  } catch ( e ) {\n    gl.deleteProgram( program );\n\n    return Promise.reject( e );\n  } finally {\n    gl.deleteShader( fragmentShader );\n    gl.deleteShader( vertexShader );\n  }\n}\n", "import { shaderchunkPost, shaderchunkPre } from './shaderchunks';\nimport { lazyProgram } from './utils/lazyProgram';\n\nconst BLOCK_SIZE = 128;\n\nexport class Renderer {\n  public readonly gl: WebGL2RenderingContext;\n  public readonly blocksPerRender: number;\n\n  public readonly __extParallel: any;\n\n  public get framesPerRender(): number {\n    return BLOCK_SIZE * this.blocksPerRender;\n  }\n\n  private __offsetBuffer: WebGLBuffer;\n  private __tfBuffers: [ WebGLBuffer, WebGLBuffer ];\n  private __transformFeedback: WebGLTransformFeedback;\n\n  private __program: WebGLProgram | null;\n  private __programCue: WebGLProgram | null;\n\n  private __dstArrays: [ Float32Array, Float32Array ];\n\n  public constructor( gl: WebGL2RenderingContext, blocksPerRender: number ) {\n    this.blocksPerRender = blocksPerRender;\n\n    this.gl = gl;\n\n    this.__extParallel = gl.getExtension( 'KHR_parallel_shader_compile' );\n\n    this.__offsetBuffer = this.__createOffsetBuffer();\n    this.__tfBuffers = [\n      this.__createTFBuffer(),\n      this.__createTFBuffer(),\n    ];\n    this.__transformFeedback = this.__createTransformFeedback( this.__tfBuffers );\n\n    this.__dstArrays = [\n      new Float32Array( this.framesPerRender ),\n      new Float32Array( this.framesPerRender ),\n    ];\n\n    this.__program = null;\n    this.__programCue = null;\n  }\n\n  /**\n   * Dispose the renderer.\n   */\n  public dispose(): void {\n    const { gl } = this;\n\n    gl.deleteBuffer( this.__offsetBuffer );\n    gl.deleteBuffer( this.__tfBuffers[ 0 ] );\n    gl.deleteBuffer( this.__tfBuffers[ 1 ] );\n\n    gl.deleteTransformFeedback( this.__transformFeedback );\n\n    gl.deleteProgram( this.__program );\n    gl.deleteProgram( this.__programCue );\n  }\n\n  /**\n   * Compile given shader code and cue the shader.\n   */\n  public async compile( code: string ): Promise<void> {\n    const { gl } = this;\n\n    const program = await lazyProgram(\n      gl,\n      shaderchunkPre + code + shaderchunkPost,\n      '#version 300 es\\nvoid main(){discard;}',\n      {\n        extParallel: this.__extParallel,\n        tfVaryings: [ 'outL', 'outR' ],\n      },\n    ).catch( ( error ) => {\n      this.__programCue = null;\n      gl.deleteProgram( this.__programCue );\n\n      throw error;\n    } );\n\n    if ( program == null ) { return; }\n\n    this.__programCue = program;\n  }\n\n  /**\n   * Apply the cue shader.\n   *\n   * It does not do nothing when cue is not set.\n   * Feel free to mash this method for no reason.\n   */\n  public applyCue(): void {\n    const { gl } = this;\n\n    if ( this.__programCue == null ) { return; }\n\n    const prevProgram = this.__program;\n    this.__program = this.__programCue;\n\n    if ( prevProgram != null ) {\n      gl.deleteProgram( prevProgram );\n    }\n    this.__programCue = null;\n  }\n\n  /**\n   * Set an uniform1f to the current program.\n   */\n  public uniform1f( name: string, value: number ): void {\n    const { gl, __program: program } = this;\n    if ( program == null ) { return; }\n\n    const location = gl.getUniformLocation( program, name );\n\n    gl.useProgram( program );\n    gl.uniform1f( location, value );\n    gl.useProgram( null );\n  }\n\n  /**\n   * Set an uniform4f to the current program.\n   */\n  public uniform4f( name: string, ...value: [ number, number, number, number ] ): void {\n    const { gl, __program: program } = this;\n    if ( program == null ) { return; }\n\n    const location = gl.getUniformLocation( program, name );\n\n    gl.useProgram( program );\n    gl.uniform4f( location, ...value );\n    gl.useProgram( null );\n  }\n\n  /**\n   * Set a texture uniform to the current program.\n   */\n  public uniformTexture( name: string, unit: number, texture: WebGLTexture ): void {\n    const { gl, __program: program } = this;\n    if ( program == null ) { return; }\n\n    const location = gl.getUniformLocation( program, name );\n\n    gl.activeTexture( gl.TEXTURE0 + unit );\n    gl.bindTexture( gl.TEXTURE_2D, texture );\n\n    gl.useProgram( program );\n    gl.uniform1i( location, unit );\n    gl.useProgram( null );\n  }\n\n  /**\n   * Render and return a buffer.\n   */\n  public async render( first: number, count: number ): Promise<[ Float32Array, Float32Array ]> {\n    const { gl, __program: program } = this;\n    if ( program == null ) {\n      return this.__dstArrays;\n    }\n\n    // attrib\n    const attribLocation = gl.getAttribLocation( program, 'off' );\n\n    gl.bindBuffer( gl.ARRAY_BUFFER, this.__offsetBuffer );\n    gl.enableVertexAttribArray( attribLocation );\n    gl.vertexAttribPointer( attribLocation, 1, gl.FLOAT, false, 0, 0 );\n\n    // render\n    gl.useProgram( program );\n    gl.bindTransformFeedback( gl.TRANSFORM_FEEDBACK, this.__transformFeedback );\n    gl.enable( gl.RASTERIZER_DISCARD );\n\n    gl.beginTransformFeedback( gl.POINTS );\n    gl.drawArrays( gl.POINTS, first, count );\n    gl.endTransformFeedback();\n\n    gl.disable( gl.RASTERIZER_DISCARD );\n    gl.bindTransformFeedback( gl.TRANSFORM_FEEDBACK, null );\n    gl.useProgram( null );\n\n    // feedback\n    gl.bindBuffer( gl.ARRAY_BUFFER, this.__tfBuffers[ 0 ] );\n    gl.getBufferSubData(\n      gl.ARRAY_BUFFER,\n      0,\n      this.__dstArrays[ 0 ],\n      first,\n      count,\n    );\n    gl.bindBuffer( gl.ARRAY_BUFFER, null );\n\n    gl.bindBuffer( gl.ARRAY_BUFFER, this.__tfBuffers[ 1 ] );\n    gl.getBufferSubData(\n      gl.ARRAY_BUFFER,\n      0,\n      this.__dstArrays[ 1 ],\n      first,\n      count,\n    );\n    gl.bindBuffer( gl.ARRAY_BUFFER, null );\n\n    return this.__dstArrays;\n  }\n\n  private __createOffsetBuffer(): WebGLBuffer {\n    const { gl, framesPerRender } = this;\n\n    const array = new Float32Array( framesPerRender )\n      .map( ( _, i ) => i );\n\n    const buffer = gl.createBuffer()!;\n\n    gl.bindBuffer( gl.ARRAY_BUFFER, buffer );\n    gl.bufferData( gl.ARRAY_BUFFER, array, gl.STATIC_DRAW );\n    gl.bindBuffer( gl.ARRAY_BUFFER, null );\n\n    return buffer;\n  }\n\n  private __createTFBuffer(): WebGLBuffer {\n    const { gl, framesPerRender } = this;\n\n    const buffer = gl.createBuffer()!;\n\n    gl.bindBuffer( gl.ARRAY_BUFFER, buffer );\n    gl.bufferData(\n      gl.ARRAY_BUFFER,\n      framesPerRender * Float32Array.BYTES_PER_ELEMENT,\n      gl.DYNAMIC_COPY,\n    );\n    gl.bindBuffer( gl.ARRAY_BUFFER, null );\n\n    return buffer;\n  }\n\n  private __createTransformFeedback(\n    tfBuffers: [ WebGLBuffer, WebGLBuffer ]\n  ): WebGLTransformFeedback {\n    const { gl } = this;\n\n    const tf = gl.createTransformFeedback()!;\n\n    gl.bindTransformFeedback( gl.TRANSFORM_FEEDBACK, tf );\n    gl.bindBufferBase( gl.TRANSFORM_FEEDBACK_BUFFER, 0, tfBuffers[ 0 ] );\n    gl.bindBufferBase( gl.TRANSFORM_FEEDBACK_BUFFER, 1, tfBuffers[ 1 ] );\n    gl.bindTransformFeedback( gl.TRANSFORM_FEEDBACK, null );\n\n    return tf;\n  }\n}\n", "import { TextureStoreEntry, TextureStoreImageEntry, TextureStoreSampleEntry, TextureStoreWavetableEntry } from './TextureStoreEntry';\n\nexport class TextureStore {\n  public readonly gl: WebGL2RenderingContext;\n\n  private __textures: Map<string, TextureStoreEntry>;\n\n  public get textureIds(): IterableIterator<string> {\n    return this.__textures.keys();\n  }\n\n  public constructor( gl: WebGL2RenderingContext ) {\n    this.gl = gl;\n\n    this.__textures = new Map();\n  }\n\n  /**\n   * Dispose all the textures.\n   */\n  public dispose(): void {\n    const { gl } = this;\n\n    this.__textures.forEach( ( texture ) => {\n      gl.deleteTexture( texture.texture );\n    } );\n\n    this.__textures.clear();\n  }\n\n  /**\n   * Get a texture.\n   */\n  public get( id: string ): TextureStoreEntry | null {\n    return this.__textures.get( id ) ?? null;\n  }\n\n  /**\n   * Load a x-y wavetable and store as a texture.\n   * The buffer have to be encoded in F32, 2048 samples per cycle.\n   *\n   * The texture name is gonna be `wavetable_${ name }`.\n   */\n  public loadWavetable( id: string, inputBuffer: Float32Array ): TextureStoreWavetableEntry {\n    const frames = inputBuffer.length / 2048;\n    const buffer = new Float32Array( inputBuffer.length * 4 );\n\n    for ( let i = 0; i < inputBuffer.length; i ++ ) {\n      buffer[ i * 4 + 0 ] = inputBuffer[ i ];\n    }\n\n    const texture = this.__uploadTexture( 2048, frames, buffer );\n\n    const entry = {\n      type: 'wavetable' as const,\n      width: 2048,\n      height: frames,\n      texture,\n    };\n    this.__textures.set( id, entry );\n    return entry;\n  }\n\n  /**\n   * Load an image and store as a texture.\n   */\n  public loadImage( id: string, image: TexImageSource ): TextureStoreImageEntry {\n    const texture = this.__uploadImageSource( image );\n\n    const entry = {\n      type: 'image' as const,\n      width: image.width,\n      height: image.height,\n      texture,\n    };\n    this.__textures.set( id, entry );\n    return entry;\n  }\n\n  /**\n   * Load a sample and store as a texture.\n   */\n  public loadSample( id: string, audioBuffer: AudioBuffer ): TextureStoreSampleEntry {\n    const { sampleRate, duration } = audioBuffer;\n    const frames = audioBuffer.length;\n    const width = 2048;\n    const lengthCeiled = Math.ceil( frames / 2048.0 );\n    const height = lengthCeiled;\n\n    const buffer = new Float32Array( width * height * 4 );\n    const channels = audioBuffer.numberOfChannels;\n\n    const dataL = audioBuffer.getChannelData( 0 );\n    const dataR = audioBuffer.getChannelData( channels === 1 ? 0 : 1 );\n\n    for ( let i = 0; i < frames; i ++ ) {\n      buffer[ i * 4 + 0 ] = dataL[ i ];\n      buffer[ i * 4 + 1 ] = dataR[ i ];\n    }\n\n    const texture = this.__uploadTexture( width, height, buffer );\n\n    const entry = {\n      type: 'sample' as const,\n      width,\n      height,\n      sampleRate,\n      duration,\n      texture,\n    };\n    this.__textures.set( id, entry );\n    return entry;\n  }\n\n  /**\n   * Delete a texture entry.\n   *\n   * Returns a boolean that indicates whether the deletion is successful or not.\n   */\n  public delete( id: string ): boolean {\n    const { gl } = this;\n\n    const texture = this.__textures.get( id );\n    if ( texture == null ) { return false; }\n\n    gl.deleteTexture( texture.texture );\n    this.__textures.delete( id );\n\n    return true;\n  }\n\n  /**\n   * Create a texture and upload data.\n   */\n  private __uploadTexture(\n    width: number,\n    height: number,\n    source: Float32Array,\n  ): WebGLTexture {\n    const { gl } = this;\n\n    const texture = gl.createTexture()!;\n\n    gl.bindTexture( gl.TEXTURE_2D, texture );\n\n    gl.texImage2D(\n      gl.TEXTURE_2D,\n      0,\n      gl.RGBA32F,\n      width,\n      height,\n      0,\n      gl.RGBA,\n      gl.FLOAT,\n      source,\n    );\n\n    gl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\n    gl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\n\n    gl.bindTexture( gl.TEXTURE_2D, null );\n\n    return texture;\n  }\n\n  /**\n   * Create a texture and upload data.\n   */\n  private __uploadImageSource(\n    source: TexImageSource,\n  ): WebGLTexture {\n    const { gl } = this;\n\n    const texture = gl.createTexture()!;\n\n    gl.bindTexture( gl.TEXTURE_2D, texture );\n\n    gl.texImage2D(\n      gl.TEXTURE_2D,\n      0,\n      gl.RGBA8,\n      gl.RGBA,\n      gl.UNSIGNED_BYTE,\n      source,\n    );\n\n    gl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR );\n    gl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR );\n\n    gl.bindTexture( gl.TEXTURE_2D, null );\n\n    return texture;\n  }\n}\n", "/**\n * `lerp`, or `mix`\n */\nexport function lerp( a: number, b: number, x: number ): number {\n  return a + ( b - a ) * x;\n}\n", "import { BeatManager } from './BeatManager';\nimport { BufferReaderNode } from './BufferReaderNode';\nimport { EventEmittable } from './utils/EventEmittable';\nimport { Renderer } from './Renderer';\nimport { TextureStore } from './TextureStore';\nimport { applyMixins } from './utils/applyMixins';\nimport { lerp } from './utils/lerp';\nimport { shaderchunkPreLines } from './shaderchunks';\n\nconst BLOCK_SIZE = 128;\n\ninterface WavenerdDeckProgram {\n  code: string;\n  requiredTextures: Set<string>;\n}\n\ninterface WavenerdDeckParamEntry {\n  name: string;\n  value: number;\n  factor: number;\n  target: number;\n}\n\nexport class WavenerdDeck {\n  /**\n   * Its host deck.\n   * It's highly recommended to connect the node of the host deck into the node of this deck, to ensure the timing consistency.\n   */\n  public hostDeck?: WavenerdDeck;\n\n  /**\n   * The count of latency blocks.\n   * Block == 128 samples.\n   * Lower == less latency.\n   */\n  public latencyBlocks: number;\n\n  /**\n   * Its current cue status.\n   * `'none'`: There is nothing in its current cue.\n   * `'ready'`: There is a cue shader and is ready to be applied.\n   * `'applying'`: There is a cue shader and is going to be applied in the next bar.\n   */\n  private __cueStatus: 'none' | 'compiling' | 'ready' | 'applying' = 'none';\n\n  /**\n   * Its current cue status.\n   * `'none'`: There is nothing in its current cue.\n   * `'ready'`: There is a cue shader and is ready to be applied.\n   * `'applying'`: There is a cue shader and is going to be applied in the next bar.\n   */\n  public get cueStatus(): 'none' | 'compiling' | 'ready' | 'applying' {\n    return this.__cueStatus;\n  }\n\n  /**\n   * Blocks per a render.\n   */\n  private __blocksPerRender: number;\n\n  /**\n   * Blocks per a render.\n   */\n  public get blocksPerRender(): number {\n    return this.__blocksPerRender;\n  }\n\n  /**\n   * Frames per a render\n   */\n  public get framesPerRender(): number {\n    return BLOCK_SIZE * this.__blocksPerRender;\n  }\n\n  /**\n   * Whether the wavenerd deck is playing or not.\n   */\n  private __isPlaying: boolean;\n\n  /**\n   * Whether the wavenerd deck is playing or not.\n   */\n  public get isPlaying(): boolean {\n    return this.hostDeck?.__isPlaying ?? this.__isPlaying;\n  }\n\n  /**\n   * Its current bpm.\n   */\n  public get bpm(): number {\n    return this.beatManager.bpm;\n  }\n  public set bpm( value: number ) {\n    this.beatManager.bpm = value;\n  }\n\n  /**\n   * Its last updated time.\n   * Intended to be used for calculation of deltaTime inside (@link __prepareBuffer).\n   */\n  private __lastUpdatedTime: number;\n\n  /**\n   * Its renderer.\n   */\n  private __renderer: Renderer;\n\n  /**\n   * Its last compile error happened in [[WavenerdDeck.compile]].\n   */\n  private __lastError: any;\n  public get lastError(): any {\n    return this.__lastError;\n  }\n\n  /**\n   * Its binded `AudioContext`.\n   */\n  private __audio: AudioContext;\n  public get audio(): AudioContext {\n    return this.__audio;\n  }\n\n  /**\n   * Its node of the AudioContext.\n   */\n  private __node: GainNode;\n  public get node(): GainNode {\n    return this.__node;\n  }\n\n  private __bufferReaderNode?: BufferReaderNode;\n  private __bufferWriteBlocks: number;\n\n  /**\n   * Offset of the block compared to {@link __bufferWriteBlocks} in terms of time.\n   * It is used to rewind the deck.\n   */\n  private __blockOffset: number;\n\n  /**\n   * Alias for the `audio.sampleRate` .\n   */\n  public get sampleRate(): number {\n    return this.__audio.sampleRate;\n  }\n\n  private __beatManager: BeatManager;\n  public get beatManager(): BeatManager {\n    const hostDeckBeatManager = this.hostDeck?.beatManager;\n    if ( hostDeckBeatManager ) {\n      return hostDeckBeatManager;\n    }\n\n    return this.__beatManager;\n  }\n\n  private __program: WavenerdDeckProgram | null;\n  private __programCue: WavenerdDeckProgram | null;\n  private __programSwapTime: number | null;\n\n  private __params = new Map<string, WavenerdDeckParamEntry>();\n  private get params(): Map<string, WavenerdDeckParamEntry> {\n    return this.__params;\n  }\n\n  private __selfTextureStore: TextureStore;\n  private get __textureStore(): TextureStore {\n    if ( this.hostDeck ) {\n      return this.hostDeck.__textureStore;\n    }\n\n    return this.__selfTextureStore;\n  }\n\n  /**\n   * Constructor of the WavenerdDeck.\n   */\n  public constructor( {\n    gl,\n    audio,\n    hostDeck,\n    latencyBlocks,\n    blocksPerRender,\n    bpm,\n  }: {\n    gl: WebGL2RenderingContext;\n    audio: AudioContext;\n    hostDeck?: WavenerdDeck;\n    latencyBlocks?: number;\n    blocksPerRender?: number;\n    bpm?: number;\n  } ) {\n    this.__isPlaying = false;\n\n    this.latencyBlocks = latencyBlocks ?? 16;\n    this.__blocksPerRender = blocksPerRender ?? 16;\n\n    // -- host deck --------------------------------------------------------------------------------\n    if ( hostDeck ) {\n      this.hostDeck = hostDeck;\n    }\n\n    // -- beat manager -----------------------------------------------------------------------------\n    this.__beatManager = new BeatManager();\n    this.__beatManager.bpm = bpm ?? 140;\n    this.__beatManager.on( 'changeBPM', ( { bpm } ) => {\n      this.__emit( 'changeBPM', { bpm } );\n    } );\n\n    this.__lastUpdatedTime = 0.0;\n\n    // TODO: temporary solution\n    if ( hostDeck ) {\n      hostDeck.on( 'rewind', () => {\n        this.rewind();\n      } );\n    }\n\n    // -- renderer ---------------------------------------------------------------------------------\n    this.__renderer = new Renderer( gl, this.blocksPerRender );\n\n    this.__selfTextureStore = new TextureStore( gl );\n\n    this.__program = null;\n    this.__programCue = null;\n    this.__programSwapTime = null;\n\n    // -- audio ------------------------------------------------------------------------------------\n    this.__audio = audio;\n    this.__node = audio.createGain();\n\n    BufferReaderNode.addModule( audio ).then( () => {\n      this.__bufferReaderNode = new BufferReaderNode( audio );\n      this.__bufferReaderNode.connect( this.__node );\n    } );\n\n    this.__bufferWriteBlocks = 0;\n    this.__blockOffset = 0;\n  }\n\n  /**\n   * Dispose this WavenerdDeck.\n   */\n  public dispose(): void {\n    this.__setCueStatus( 'none' );\n\n    this.__renderer.dispose();\n    this.__selfTextureStore.dispose();\n\n    this.__bufferReaderNode?.disconnect();\n  }\n\n  /**\n   * Play the deck.\n   */\n  public play(): void {\n    this.__isPlaying = true;\n\n    this.__emit( 'play' );\n  }\n\n  /**\n   * Pause the deck.\n   */\n  public pause(): void {\n    this.__isPlaying = false;\n\n    this.__emit( 'pause' );\n  }\n\n  /**\n   * Rewind the deck.\n   */\n  public rewind(): void {\n    this.__lastUpdatedTime = 0.0;\n    this.__blockOffset = this.__bufferWriteBlocks;\n\n    this.__beatManager.reset();\n\n    this.applyCueImmediately();\n\n    this.__emit( 'rewind' );\n  }\n\n  /**\n   * Compile given shader code and cue the shader.\n   */\n  public async compile( code: string ): Promise<void> {\n    this.__setCueStatus( 'compiling' );\n\n    await this.__renderer.compile( code ).catch( ( e ) => {\n      const error = this.__processErrorMessage( e );\n\n      this.__programCue = null;\n\n      this.__setCueStatus( 'none' );\n\n      this.__emit( 'error', { error } );\n      this.__lastError = error;\n\n      throw new Error( error ?? undefined );\n    } );\n\n    const requiredTextures = new Set<string>();\n\n    for ( const id of this.__textureStore.textureIds ) {\n      if ( code.search( id ) !== -1 ) {\n        requiredTextures.add( id );\n      }\n    }\n\n    this.__programCue = {\n      code,\n      requiredTextures,\n    };\n\n    this.__setCueStatus( 'ready' );\n\n    this.__emit( 'error', { error: null } );\n    this.__lastError = null;\n  }\n\n  /**\n   * Apply the cue shader after the bar ends.\n   */\n  public applyCue(): void {\n    if ( this.__cueStatus === 'ready' ) {\n      this.__setCueStatus( 'applying' );\n\n      this.__programSwapTime =\n        this.beatManager.time - this.beatManager.bar + this.beatManager.barSeconds;\n    }\n  }\n\n  /**\n   * Apply the cue shader immediately.\n   */\n  public applyCueImmediately(): void {\n    if ( this.__programCue != null ) {\n      this.__setCueStatus( 'none' );\n\n      this.__renderer.applyCue();\n\n      this.__program = this.__programCue;\n      this.__programCue = null;\n      this.__programSwapTime = null;\n    }\n  }\n\n  /**\n   * Set a uniform value.\n   */\n  public setParam( name: string, value: number, factor = 50.0 ): void {\n    const param = this.params.get( name );\n    if ( param ) {\n      param.target = value;\n      param.factor = factor;\n    } else {\n      this.params.set( name, { name, target: value, value, factor } );\n    }\n\n    this.__emit( 'setParam', { name, value, factor } );\n  }\n\n  /**\n   * Load a x-y wavetable and store as a uniform texture.\n   * The buffer have to be encoded in F32, 2048 samples per cycle.\n   */\n  public loadWavetable(\n    name: string,\n    inputBuffer: Float32Array,\n  ): void {\n    const id = `wavetable_${ name }`;\n    this.__textureStore.loadWavetable( id, inputBuffer );\n\n    this.__addRequiredTexture( id );\n\n    this.__emit( 'loadWavetable', { name } );\n  }\n\n  /**\n   * Delete a wavetable.\n   */\n  public deleteWavetable( name: string ): void {\n    const isSuccess = this.__textureStore.delete( `wavetable_${ name }` );\n\n    if ( isSuccess ) {\n      this.__emit( 'deleteWavetable', { name } );\n    }\n  }\n\n  /**\n   * Load an image and store as a uniform texture.\n   */\n  public loadImage(\n    name: string,\n    image: TexImageSource,\n  ): void {\n    const id = `image_${ name }`;\n    this.__textureStore.loadImage( id, image );\n\n    this.__addRequiredTexture( id );\n\n    this.__emit( 'loadImage', { name } );\n  }\n\n  /**\n   * Delete an image.\n   */\n  public deleteImage( name: string ): void {\n    const isSuccess = this.__textureStore.delete( `image_${ name }` );\n\n    if ( isSuccess ) {\n      this.__emit( 'deleteImage', { name } );\n    }\n  }\n\n  /**\n   * Load a sample and store as a uniform texture.\n   */\n  public async loadSample( name: string, inputBuffer: ArrayBuffer ): Promise<void> {\n    const audioBuffer = await this.__audio.decodeAudioData( inputBuffer );\n\n    const id = `sample_${ name }`;\n    const { duration, sampleRate } = this.__textureStore.loadSample( id, audioBuffer );\n\n    this.__addRequiredTexture( id );\n\n    this.__emit( 'loadSample', { name, duration, sampleRate } );\n  }\n\n  /**\n   * Delete a sample.\n   */\n  public deleteSample( name: string ): void {\n    const isSuccess = this.__textureStore.delete( `success_${ name }` );\n\n    if ( isSuccess ) {\n      this.__emit( 'deleteSample', { name } );\n    }\n  }\n\n  public async update(): Promise<void> {\n    const bufferReaderNode = this.__bufferReaderNode;\n    if ( bufferReaderNode == null ) { return; }\n\n    const { readBlocks } = bufferReaderNode;\n    const { sampleRate, blocksPerRender, framesPerRender } = this;\n\n    this.__bufferReaderNode?.setActive( this.isPlaying );\n\n    // -- early abort? -----------------------------------------------------------------------------\n    if ( !this.isPlaying ) { return; }\n\n    // -- choose a right write block ---------------------------------------------------------------\n    const blockAhead = this.__bufferWriteBlocks - readBlocks;\n\n    // we don't have to render this time\n    if ( blockAhead > this.latencyBlocks ) {\n      return;\n    }\n\n    // we're very behind\n    if ( blockAhead < 0 ) {\n      this.__bufferWriteBlocks = (\n        Math.floor( readBlocks / blocksPerRender ) + 1\n      ) * blocksPerRender;\n    }\n\n    const genTime = BLOCK_SIZE * ( this.__bufferWriteBlocks - this.__blockOffset ) / sampleRate;\n    this.beatManager.update( genTime );\n\n    // -- should I process the next program? -------------------------------------------------------\n    let beginNext = this.__programSwapTime != null\n      ? Math.floor( ( this.__programSwapTime - genTime ) * sampleRate )\n      : Infinity;\n    beginNext = Math.min( beginNext, framesPerRender );\n\n    // -- swap the program from first --------------------------------------------------------------\n    if ( beginNext < 0 ) {\n      this.applyCueImmediately();\n\n      beginNext = framesPerRender;\n    }\n\n    // -- render -----------------------------------------------------------------------------------\n    if ( this.__program ) {\n      await this.__prepareBuffer( 0, beginNext );\n    }\n\n    // -- render the next program from the mid of the block ----------------------------------------\n    if ( beginNext < framesPerRender && this.__programCue != null ) {\n      this.applyCueImmediately();\n\n      await this.__prepareBuffer( beginNext, framesPerRender - beginNext );\n    }\n\n    // -- update write blocks ----------------------------------------------------------------------\n    this.__bufferWriteBlocks += this.blocksPerRender;\n\n    // -- emit an event ----------------------------------------------------------------------------\n    this.__emit( 'update' );\n  }\n\n  private __addRequiredTexture( id: string ): void {\n    if ( this.__program && this.__program.code.search( id ) ) {\n      this.__program.requiredTextures.add( id );\n    }\n\n    if ( this.__programCue && this.__programCue.code.search( id ) ) {\n      this.__programCue.requiredTextures.add( id );\n    }\n  }\n\n  private async __prepareBuffer(\n    first: number,\n    count: number\n  ): Promise<void> {\n    const bufferReaderNode = this.__bufferReaderNode;\n    if ( bufferReaderNode == null ) { return; }\n\n    const {\n      time,\n      beatSeconds,\n      barSeconds,\n      sixteenBarSeconds,\n      beat,\n      bar,\n      sixteenBar,\n    } = this.beatManager;\n    const { sampleRate } = this;\n\n    const delta = time - this.__lastUpdatedTime;\n    this.__lastUpdatedTime = time;\n\n    // render\n    this.params.forEach( ( param ) => {\n      if ( param.factor <= 0.0 ) {\n        param.value = param.target;\n      } else {\n        param.value = lerp( param.target, param.value, Math.exp( -param.factor * delta ) );\n      }\n\n      this.__renderer.uniform4f(\n        'param_' + param.name,\n        param.target,\n        param.value,\n        param.factor,\n        0.0\n      );\n    } );\n\n    let textureUnit = 0;\n\n    const { requiredTextures } = this.__program!;\n\n    for ( const textureName of requiredTextures ) {\n      const textureEntry = this.__textureStore.get( textureName );\n\n      if ( textureEntry != null ) {\n        this.__renderer.uniformTexture(\n          textureName,\n          textureUnit,\n          textureEntry.texture,\n        );\n        textureUnit ++;\n\n        const meta = (\n          textureEntry.type === 'sample'\n            ? [\n              textureEntry.width,\n              textureEntry.height,\n              textureEntry.sampleRate,\n              textureEntry.duration,\n            ]\n            : [\n              textureEntry.width,\n              textureEntry.height,\n              0,\n              0,\n            ]\n        ) as [ number, number, number, number ];\n\n        this.__renderer.uniform4f(\n          textureName + '_meta',\n          ...meta,\n        );\n      }\n    }\n\n    this.__renderer.uniform1f( 'bpm', this.bpm );\n    this.__renderer.uniform1f( '_deltaSample', 1.0 / sampleRate );\n    this.__renderer.uniform4f(\n      'timeLength',\n      beatSeconds,\n      barSeconds,\n      sixteenBarSeconds,\n      1E16\n    );\n    this.__renderer.uniform4f(\n      '_timeHead',\n      beat,\n      bar,\n      sixteenBar,\n      time\n    );\n\n    const [ outL, outR ] = await this.__renderer.render( first, count );\n\n    bufferReaderNode.write(\n      0,\n      this.__bufferWriteBlocks,\n      first,\n      outL.subarray( first, first + count ),\n    );\n\n    bufferReaderNode.write(\n      1,\n      this.__bufferWriteBlocks,\n      first,\n      outR.subarray( first, first + count ),\n    );\n  }\n\n  private __setCueStatus( cueStatus: 'none' | 'compiling' | 'ready' | 'applying' ): void {\n    this.__cueStatus = cueStatus;\n    this.__emit( 'changeCueStatus', { cueStatus } );\n  }\n\n  private __processErrorMessage( error: any ): string | null {\n    const str: string | undefined = error?.message ?? error;\n    if ( !str ) { return null; }\n\n    return str.replace( /ERROR: (\\d+):(\\d+)/g, ( match, ...args ) => {\n      const line = parseInt( args[ 1 ] ) - shaderchunkPreLines + 1;\n      return `ERROR: ${ args[ 0 ] }:${ line }`;\n    } );\n  }\n}\n\nexport interface WavenerdDeck extends EventEmittable<{\n  update: void;\n  play: void;\n  pause: void;\n  rewind: void;\n  changeCueStatus: { cueStatus: 'none' | 'compiling' | 'ready' | 'applying' };\n  setParam: { name: string; value: number; factor: number };\n  loadWavetable: { name: string };\n  deleteWavetable: { name: string };\n  loadImage: { name: string };\n  deleteImage: { name: string };\n  loadSample: { name: string; sampleRate: number; duration: number };\n  deleteSample: { name: string };\n  changeBPM: { bpm: number };\n  error: { error: string | null };\n}> {}\napplyMixins( WavenerdDeck, [ EventEmittable ] );\n"],
  "mappings": "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",
  "names": []
}
